<!DOCTYPE html>

<div id="app"></div>

<script src="./dist/VirtualDOM.js"></script>
<script>
window.VirtualDOM = window.VirtualDOM['default']
let vdom = new VirtualDOM({
  template: `
    <div id="{{id}}">
      <p>{{text}}</p>
      <p><a href="javascript:" onclick="{{:click}}">click me to refresh content</a></p>
      <p><input onkeyup="{{:input}}" value=""></p>
      <p><input type="checkbox"><label>check me</label></p>
      <p><select>
        <option>click to change</option>
        <option>touch to change</option>  
      </select></p>
      <ul>
        <@foreach target="cats" key="name" value="color">
          <li>{{name}}'s color is {{color}}</li>
        </@foreach>
      </ul>
      <@if condition="{{isShow}}">
        <p>this will be show.</p>
      </@if>
      <p><a href="javascript:" onclick="{{:toggle}}">toggle</a></p>
      <@my-directive ontrigger={{:trigger}}>
        <span>this is my custom directive</span>
      </@my-directive>
    </div>
  `,
  data: {
    id: 'my-test',
    text: 'this is my first VirtualDOM demo.',
    cats: {
      caf: 'red',
      sam: 'yellow',
    },
    isShow: true,
  },
  events: {
    input(e) {
      e.target.value = 'xxx'
    },
    click(e) {
      e.preventDefault()
      vdom.update({
        text: 'this is new content ' + Date.now(),
      })
    },
    toggle(e) {
      e.preventDefault()
      vdom.update({
        isShow: !vdom.data.isShow,
      })
    },
    trigger(msg) {
      alert(msg)
    },
  },
  directives: {
    'my-directive': (attrs, events, children) => {
      let myVDOM = new VirtualDOM({
        template: `
          <div class="my-custom-directive" onclick={{:click}}></div>
        `,
        events: {
          click(e) {
            events.trigger('dont click me!')
          },
        },
      })
      let vnodes = myVDOM.createVirtualDOM()
      vnodes[0].children = children
      return vnodes
    },
  },
  selector: '#app',
})
vdom.render()
</script>
